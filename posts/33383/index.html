<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>知识集锦2 | 贵祥</title><meta name="author" content="Gui_xiang"><meta name="copyright" content="Gui_xiang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="通配符通配符是shell在做PathnameExpansion时用到的。说白了一般只用于文件名匹配，它是由shell解析的，比如 find，ls，cp，mv等 shell常见通配符 123456*：匹配0或多个字符?：匹配任意一个字符[list]：匹配list中任意单个字符[c1‐c2]：匹配c1‐c2中任意单个字符[^c1‐c2]&#x2F;[!c1‐c2]：不匹配c1‐c2中任意字符&#123;stri">
<meta property="og:type" content="article">
<meta property="og:title" content="知识集锦2">
<meta property="og:url" content="http://blog.guixiang.top/posts/33383/index.html">
<meta property="og:site_name" content="贵祥">
<meta property="og:description" content="通配符通配符是shell在做PathnameExpansion时用到的。说白了一般只用于文件名匹配，它是由shell解析的，比如 find，ls，cp，mv等 shell常见通配符 123456*：匹配0或多个字符?：匹配任意一个字符[list]：匹配list中任意单个字符[c1‐c2]：匹配c1‐c2中任意单个字符[^c1‐c2]&#x2F;[!c1‐c2]：不匹配c1‐c2中任意字符&#123;stri">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.aqcoder.cn/random">
<meta property="article:published_time" content="2024-03-29T14:23:01.805Z">
<meta property="article:modified_time" content="2024-03-30T13:49:19.166Z">
<meta property="article:author" content="Gui_xiang">
<meta property="article:tag" content="知识集锦">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.aqcoder.cn/random"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://blog.guixiang.top/posts/33383/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '知识集锦2',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-30 21:49:19'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-sitemap"></i><span> 站点</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yuque.com/g/wushi-ls7km/vvnwch/ifpqbuycxhflla9m/collaborator/join?token=D22lKgPZBNY46DIs&amp;source=doc_collaborator"><i class="fa-fw fa fa-paper-plane"></i><span> 这是一个语雀跳转网站</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun"><i class="fa-fw iconfont icon-Bing"></i><span> 进入大本营</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun:8443"><i class="fa-fw fa fa-heartbeat"></i><span> 进入harbor</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun:55551"><i class="fa-fw fa fa-folder"></i><span> 进入vscode</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/share/"><i class="fa-fw fa fa-share-alt-square"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.cn"><i class="fa-fw fa fa-train"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://foreverblog.cn/go.html"><i class="fa-fw fa fa-circle"></i><span> 虫洞</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.aqcoder.cn/random')"><nav id="nav"><span id="blog-info"><a href="/" title="贵祥"><img class="site-icon" src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/Screenshot%202024-03-18%20220634.png"/><span class="site-name">贵祥</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-sitemap"></i><span> 站点</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yuque.com/g/wushi-ls7km/vvnwch/ifpqbuycxhflla9m/collaborator/join?token=D22lKgPZBNY46DIs&amp;source=doc_collaborator"><i class="fa-fw fa fa-paper-plane"></i><span> 这是一个语雀跳转网站</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun"><i class="fa-fw iconfont icon-Bing"></i><span> 进入大本营</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun:8443"><i class="fa-fw fa fa-heartbeat"></i><span> 进入harbor</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://www.guixiang.fun:55551"><i class="fa-fw fa fa-folder"></i><span> 进入vscode</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-bookmark"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/share/"><i class="fa-fw fa fa-share-alt-square"></i><span> 分享</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fa fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.cn"><i class="fa-fw fa fa-train"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://foreverblog.cn/go.html"><i class="fa-fw fa fa-circle"></i><span> 虫洞</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">知识集锦2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-29T14:23:01.805Z" title="发表于 2024-03-29 22:23:01">2024-03-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-03-30T13:49:19.166Z" title="更新于 2024-03-30 21:49:19">2024-03-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="知识集锦2"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h1><p>通配符是shell在做PathnameExpansion时用到的。说白了一般只<strong>用于文件名匹配</strong>，它是由shell解析的，比如 find，ls，cp，mv等 shell常见通配符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*：匹配0或多个字符</span><br><span class="line">?：匹配任意一个字符</span><br><span class="line">[list]：匹配list中任意单个字符</span><br><span class="line">[c1‐c2]：匹配c1‐c2中任意单个字符</span><br><span class="line">[^c1‐c2]/[!c1‐c2]：不匹配c1‐c2中任意字符</span><br><span class="line">&#123;string1,string2,...&#125;：匹配&#123;&#125;中任意单个字符串</span><br></pre></td></tr></table></figure>

<ul>
<li>shell 元字符</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">IFS：&lt;tab&gt;/&lt;space&gt;/&lt;enter&gt;</span><br><span class="line">CR：&lt;enter&gt;</span><br><span class="line">=：设定变量</span><br><span class="line">$：取变量值</span><br><span class="line">&gt;/&lt; ：重定向</span><br><span class="line">|：管道</span><br><span class="line">&amp;：后台执行命令</span><br><span class="line">()：在子shell中执行命令/运算或命令替换</span><br><span class="line">&#123;&#125;：函数中执行/变量替换的界定范围</span><br><span class="line">;：命令结束后，忽略其返回值，继续执行下一个命令</span><br><span class="line">&amp;&amp;：命令结束后，若为true，继续执行下一个命令</span><br><span class="line">||：命令结束后，若为false，继续执行下一个命令</span><br><span class="line">！：非</span><br><span class="line">#：注释</span><br><span class="line">\：转义符</span><br></pre></td></tr></table></figure>

<ul>
<li>shell转义符</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;：硬转义，内部所有shell元字符，通配符都会被关掉</span><br><span class="line">&quot;&quot;：软转义，内部</span><br></pre></td></tr></table></figure>

<h1 id="find文件查找"><a href="#find文件查找" class="headerlink" title="find文件查找"></a>find文件查找</h1><ul>
<li>实时查找工具，通过遍历指定路径下的文件系统完成文件查找</li>
<li>工作特点<ul>
<li>查找速度略慢</li>
<li>精确查找</li>
<li>实时查找</li>
<li>可以满足多种条件匹配</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find [选项] [路径] [查找条件 + 处理动作]</span><br><span class="line">查找路径：指定具体目录路径，默认是当前文件夹</span><br><span class="line">查找条件：指定的查找标准（文件名/大小/类型/权限等），默认是找出所有文件</span><br><span class="line">处理动作：对符合条件的文件做什么操作，默认输出屏幕</span><br></pre></td></tr></table></figure>

<h2 id="查找条件"><a href="#查找条件" class="headerlink" title="查找条件"></a>查找条件</h2><ul>
<li>查找条件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">根据文件名查找：</span><br><span class="line">    ‐name &quot;filename&quot; 支持global</span><br><span class="line">    ‐iname &quot;filename&quot; 忽略大小写</span><br><span class="line">    ‐regex &quot;PATTERN&quot; 以Pattern匹配整个文件路径字符串，而不仅仅是文件名称</span><br><span class="line">根据属主和属组查找：</span><br><span class="line">    ‐user USERNAME：查找属主为指定用户的文件</span><br><span class="line">    ‐group GROUPNAME：查找属组为指定属组的文件</span><br><span class="line">    ‐uid UserID：查找属主为指定的ID号的文件</span><br><span class="line">    ‐gid GroupID：查找属组为指定的GID号的文件</span><br><span class="line">    ‐nouser：查找没有属主的文件</span><br><span class="line">    ‐nogroup：查找没有属组的文件</span><br><span class="line">根据文件类型查找：</span><br><span class="line">    ‐type Type：</span><br><span class="line">    f/d/l/s/b/c/p</span><br><span class="line">根据文件大小来查找：</span><br><span class="line">    ‐size [+|‐]N[bcwkMG]</span><br><span class="line">根据时间戳:</span><br><span class="line">    天：</span><br><span class="line">        ‐atime [+|‐]N</span><br><span class="line">        ‐mtime</span><br><span class="line">        ‐ctime</span><br><span class="line">    分钟：</span><br><span class="line">        ‐amin N</span><br><span class="line">        ‐cmin N</span><br><span class="line">        ‐mmin N</span><br><span class="line">根据权限查找：</span><br><span class="line">    ‐perm [+|‐]MODE</span><br><span class="line">    MODE：精确权限匹配</span><br><span class="line">    /MODE：任何一类(u，g，o)对象的权限中只要能一位匹配即可</span><br><span class="line">    ‐MODE：每一类对象都必须同时拥有为其指定的权限标准</span><br><span class="line">组合条件：</span><br><span class="line">    与：‐a</span><br><span class="line">    或：‐o</span><br><span class="line">    非：‐not</span><br><span class="line">相关案例：找出/tmp目录下，属主不是root，且文件名不是fstab的文件：</span><br><span class="line">find /tmp \( -not -user root -a -not -name fstab \) -ls</span><br></pre></td></tr></table></figure>

<ul>
<li>根据文件名查找</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /etc -name &quot;ifcfg-ens33&quot;</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -iname &quot;ifcfg-ens33&quot;    # 忽略大小写</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -iname &quot;ifcfg*&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按文件大小</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /etc -size +5M    # 大于5M</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -size 5M    # 等于5M</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -size -5M    # 小于5M</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -size +5M -ls    # 找到的处理动作-ls</span></span><br></pre></td></tr></table></figure>

<ul>
<li>指定查找的目录深度</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find / -maxdepth 3 -a -name &quot;ifcfg-ens33&quot;    # 最大查找深度</span></span><br><span class="line"><span class="comment"># -a是同时满足，-o是或</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find / -mindepth 3 -a -name &quot;ifcfg-ens33&quot;    # 最小查找深度</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按时间找</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /etc -mtime +5        # 修改时间超过5天</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -mtime 5        # 修改时间等于5天</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /etc -mtime -5        # 修改时间5天以内</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按照文件属主、属组找</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /home -user xwz    # 属主是xwz的文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -group xwz</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -user xwz -group xwz</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -user xwz -a -group root</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -user xwz -o -group root</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -nouser        # 没有属主的文件</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find /home -nogroup        # 没有属组的文件</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按文件类型</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /dev -type d</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按文件权限</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find / -perm 644 -ls      </span></span><br><span class="line">[root@localhost ~]<span class="comment"># find / -perm -644 -ls    # 权限小于644的</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find / -perm 4000 -ls</span></span><br><span class="line">[root@localhost ~]<span class="comment"># find / -perm -4000 -ls</span></span><br></pre></td></tr></table></figure>

<ul>
<li>按正则表达式</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># find /etc -regex &#x27;.*ifcfg-ens[0-9][0-9]&#x27;</span></span><br><span class="line"><span class="comment"># .*    任意多个字符</span></span><br><span class="line"><span class="comment"># [0-9]    任意一个数字</span></span><br></pre></td></tr></table></figure>

<ul>
<li>条件组合</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-a：多个条件and并列</span><br><span class="line">-o：多个条件or并列</span><br><span class="line">-not：条件取反</span><br></pre></td></tr></table></figure>

<h2 id="处理动作"><a href="#处理动作" class="headerlink" title="处理动作"></a>处理动作</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">‐<span class="built_in">print</span>：默认的处理动作，显示至屏幕</span><br><span class="line">‐<span class="built_in">ls</span>：类型于对查找到的文件执行“<span class="built_in">ls</span> ‐l”命令</span><br><span class="line">‐delete：删除查找到的文件</span><br><span class="line">‐fls /path/to/somefile：查找到的所有文件的长格式信息保存至指定文件中</span><br><span class="line">‐ok COMMAND &#123;&#125;\：对查找到的每个文件执行由COMMAND指定的命令</span><br><span class="line">对于每个文件执行命令之前，都会交换式要求用户确认</span><br><span class="line">‐<span class="built_in">exec</span> COMMAND &#123;&#125; \：对查找到的每个文件执行由COMMAND指定的命令</span><br><span class="line">[root@server1 ~]<span class="comment"># find /etc/init.d/ -perm -111 -exec cp -r &#123;&#125; dir1/ \;</span></span><br><span class="line">&#123;&#125;：用于引用查找到的文件名称自身</span><br><span class="line">注意：find传递查找到的文件至后面指定的命令时，查找到所有符合条件的文件一次性传递给后面的命令；另一种方式可规避此问题</span><br><span class="line">find | xargs COMMAND</span><br></pre></td></tr></table></figure>

<h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><p>正则表达式是用来匹配字符串的，针对文件内容的文本过滤工具里，大都用到正则表达式，如vi，grep，awk， sed等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">##字符匹配</span><br><span class="line">    .：匹配任意单个字符</span><br><span class="line">    []：匹配指定范围内任意单个字符 [a-z] [0-9]</span><br><span class="line">    [^]：匹配指定范围外任意单个字符 [^a-z] [^0-9]</span><br><span class="line">    [:alnum:]：字母与数字字符</span><br><span class="line">    [:alpha:]：字母</span><br><span class="line">    [:ascii:]：ASCII字符</span><br><span class="line">    [:blank:]：空格或制表符</span><br><span class="line">    [:cntrl:]：ASCII控制字符</span><br><span class="line">    [:digit:]：数字</span><br><span class="line">    [:graph:]：非控制、非空格字符</span><br><span class="line">    [:lower:]：小写字母</span><br><span class="line">    [:print:]：可打印字符</span><br><span class="line">    [:punct:]：标点符号字符</span><br><span class="line">    [:space:]：空白字符，包括垂直制表符</span><br><span class="line">    [:upper:]：大写字母</span><br><span class="line">    [:xdigit:]：十六进制数字</span><br><span class="line">##匹配次数</span><br><span class="line">    *：匹配前面的字符任意次数</span><br><span class="line">    .*：匹配任意长度的字符</span><br><span class="line">    \?：匹配其前面字符0或1次，即前面的可有可无 &#x27;a\?b&#x27;</span><br><span class="line">    \+：匹配其前面的字符至少1次 &#x27;a\+b&#x27;</span><br><span class="line">    \&#123;m\&#125;：匹配前面的字符m次</span><br><span class="line">    \&#123;m,n\&#125;：匹配前面的字符至少m次，至多n次</span><br><span class="line">    \&#123;0,n\&#125;：匹配前面的字符至多n次</span><br><span class="line">    \&#123;m,\&#125;：匹配前面的字符至少m次</span><br><span class="line">##位置锚定</span><br><span class="line">    ^：行首锚定，用于模式的最左侧</span><br><span class="line">    $：行末锚定，用于模式的最右侧</span><br><span class="line">    ^PATTERN$：用于模式匹配整行；</span><br><span class="line">    ^$：空行</span><br><span class="line">    \&lt; 或 \b：词首锚定，用于单词模式的左侧 </span><br><span class="line">    \&gt; 或 \b：词尾锚定，用于单词模式的右侧 </span><br><span class="line">    \&lt;PATTERN\&gt;：匹配整个单词 &#x27;\&lt;hello\&gt;&#x27;</span><br><span class="line">##分组</span><br><span class="line">    \(\):将一个或多个字符捆绑在一起；当作一个字符</span><br><span class="line">    \(xy\)*ab           </span><br><span class="line">    Note：分组括号中的模式匹配到的内容会被正则表达式引擎记录于内部的变量中，这些变量的命令方式为：</span><br><span class="line">    \1，\2，\3……</span><br><span class="line">    \1：从左侧起，第一个左括号以及与之匹配右括号之间的模式所匹配到的字符；</span><br><span class="line">    \(ab\+\(xy\)*\):</span><br><span class="line">    \1：ab\+\(xy\)*</span><br><span class="line">    \2：xy</span><br></pre></td></tr></table></figure>

<ul>
<li>扩展正则表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">##字符匹配</span><br><span class="line">.</span><br><span class="line">[]</span><br><span class="line">[^]</span><br><span class="line">##次数匹配</span><br><span class="line">*</span><br><span class="line">？：0次或1次</span><br><span class="line">+：1次或多次</span><br><span class="line">&#123;m&#125;:匹配m次</span><br><span class="line">&#123;m,n&#125;：至少m次，至多n次</span><br><span class="line">##位置锚定</span><br><span class="line">##分组</span><br><span class="line">()</span><br><span class="line">##或者</span><br><span class="line">a|b</span><br><span class="line">C | cat ：C或cat</span><br><span class="line">(C|c)at : C或c</span><br></pre></td></tr></table></figure>

<h1 id="Linux三剑客之grep"><a href="#Linux三剑客之grep" class="headerlink" title="Linux三剑客之grep"></a>Linux三剑客之grep</h1><p>grep作用：过滤文本内容</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-E :–extended–regexp</td>
<td align="left">模式是扩展正则表达式（ERE）</td>
</tr>
<tr>
<td align="left">-i :–ignore–case</td>
<td align="left">忽略大小写</td>
</tr>
<tr>
<td align="left">-n: –line–number</td>
<td align="left">打印行号</td>
</tr>
<tr>
<td align="left">-o:–only–matching</td>
<td align="left">只打印匹配的内容</td>
</tr>
<tr>
<td align="left">-c:–count</td>
<td align="left">只打印每个文件匹配的行数</td>
</tr>
<tr>
<td align="left">-B:–before–context&#x3D;NUM</td>
<td align="left">打印匹配的前几行</td>
</tr>
<tr>
<td align="left">-A:–after–context&#x3D;NUM</td>
<td align="left">打印匹配的后几行</td>
</tr>
<tr>
<td align="left">-C:–context&#x3D;NUM</td>
<td align="left">打印匹配的前后几行</td>
</tr>
<tr>
<td align="left">–color[&#x3D;WHEN]</td>
<td align="left">匹配的字体颜色，别名已定义了</td>
</tr>
<tr>
<td align="left">-v:–invert–match</td>
<td align="left">打印不匹配的行</td>
</tr>
<tr>
<td align="left">-e</td>
<td align="left">多点操作eg：grep -e “^s” -e “s$”</td>
</tr>
</tbody></table>
<p>样本文件内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat m </span></span><br><span class="line">asdkahsduoa</span><br><span class="line">aslkdsl</span><br><span class="line">oiofr</span><br><span class="line">sdjo</span><br><span class="line">A</span><br><span class="line">F</span><br><span class="line">aSDD</span><br><span class="line">CASDC</span><br><span class="line"></span><br><span class="line">asdo</span><br><span class="line">ca</span><br></pre></td></tr></table></figure>

<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>实例1：打印出所有的a无论大小写 ： -i选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -i &quot;a&quot; test</span></span><br><span class="line">asdkahsduoa</span><br><span class="line">aslkdsl</span><br><span class="line">A</span><br><span class="line">aSDD</span><br><span class="line">CASDC</span><br><span class="line">asdo</span><br><span class="line">ca</span><br></pre></td></tr></table></figure>

<p>实例2：打印出所有的a无论大小写，并且显示该字符串所在的行 ： -n选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -in &quot;a&quot; test</span></span><br><span class="line">1:asdkahsduoa</span><br><span class="line">2:aslkdsl</span><br><span class="line">5:A</span><br><span class="line">7:aSDD</span><br><span class="line">8:CASDC</span><br><span class="line">10:asdo</span><br><span class="line">11:ca</span><br></pre></td></tr></table></figure>

<p>实例3：仅仅打印出所有匹配的字符串： -o选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -io &quot;a&quot; test</span></span><br><span class="line">a</span><br><span class="line">a</span><br><span class="line">a</span><br><span class="line">a</span><br><span class="line">A</span><br><span class="line">a</span><br><span class="line">A</span><br><span class="line">a</span><br><span class="line">a</span><br></pre></td></tr></table></figure>

<p>实例4：打印出匹配的字符串有多少行 -c选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -ic &quot;a&quot; test</span></span><br><span class="line">7</span><br></pre></td></tr></table></figure>

<p>实例5：打印出字符S前面的2行 -B</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -B 2 &quot;S&quot; test</span></span><br><span class="line">A</span><br><span class="line">F</span><br><span class="line">aSDD</span><br><span class="line">CASDC</span><br></pre></td></tr></table></figure>

<p>实例6：打印出字符S后面的2行 -A</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -A 2 &quot;S&quot; test</span></span><br><span class="line">aSDD</span><br><span class="line">CASDC</span><br><span class="line"></span><br><span class="line">asdo</span><br></pre></td></tr></table></figure>

<p>实例7：打印出字符S前后2行 -C</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -C 2 &quot;S&quot; test</span></span><br><span class="line">A</span><br><span class="line">F</span><br><span class="line">aSDD</span><br><span class="line">CASDC</span><br><span class="line"></span><br><span class="line">asdo</span><br></pre></td></tr></table></figure>

<p>实例8：打印出不包含大小s的所有行 取反 -v</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -iv &quot;S&quot; test</span></span><br><span class="line">oiofr</span><br><span class="line">A</span><br><span class="line">F</span><br><span class="line"></span><br><span class="line">ca</span><br></pre></td></tr></table></figure>

<p>grep可以从文件当中直接搜索某个关键词,也可以从标准输入里面搜索</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep root /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/passwd | grep &quot;root&quot;</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h2 id="正则表达式（基于grep）"><a href="#正则表达式（基于grep）" class="headerlink" title="正则表达式（基于grep）"></a>正则表达式（基于grep）</h2><ul>
<li>功能就是用来检索、替换那些符合某个模式(规则)的文本,正则表达式在每种语言中都会有;</li>
<li>正则表达式就是为了处理大量的文本或字符串而定义的一套规则和方法</li>
<li>通过定义的这些特殊符号的辅助，系统管理员就可以快速过滤，替换或输出需要的字符串</li>
<li>Linux正则表达式一般以行为单位处理</li>
</ul>
<h3 id="基础正则表达式"><a href="#基础正则表达式" class="headerlink" title="基础正则表达式"></a>基础正则表达式</h3><table>
<thead>
<tr>
<th align="center">符号</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">.</td>
<td align="left">匹配任意单个字符（必须存在）</td>
</tr>
<tr>
<td align="center">^</td>
<td align="left">匹配以某个字符开头的行</td>
</tr>
<tr>
<td align="center">$</td>
<td align="left">配以什么字符结尾的行</td>
</tr>
<tr>
<td align="center">*</td>
<td align="left">匹配前面的一个字符出现0次或者多次；eg：a*b</td>
</tr>
<tr>
<td align="center">.*</td>
<td align="left">表示任意长度的任意字符</td>
</tr>
<tr>
<td align="center">[]</td>
<td align="left">表示匹配括号内的一个字符</td>
</tr>
<tr>
<td align="center">[^]</td>
<td align="left">匹配[^字符]之外的任意一个字符</td>
</tr>
<tr>
<td align="center">[]</td>
<td align="left">匹配非[^字符]内字符开头的行</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="left">锚定 单词首部；eg：&lt;root</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="left">锚定 单词尾部：eg：root&gt;</td>
</tr>
<tr>
<td align="center">{m,n}</td>
<td align="left">表示匹配前面的字符出现至少m次，至多n次</td>
</tr>
<tr>
<td align="center">()</td>
<td align="left">表示对某个单词进行分组；\1表示第一个分组进行调用</td>
</tr>
</tbody></table>
<h3 id="扩展正则"><a href="#扩展正则" class="headerlink" title="扩展正则"></a>扩展正则</h3><ul>
<li>egrep …</li>
<li>grep -E …</li>
<li>扩展正则支持所有基础正则；并有补充</li>
<li>扩展正则中{}和[]不用转义可以直接使用；</li>
</ul>
<table>
<thead>
<tr>
<th align="center">符号</th>
<th align="left">描述</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td align="left">表示前面的字符至少出现1次的情况</td>
<td></td>
</tr>
<tr>
<td align="center">\</td>
<td align="left"></td>
<td>表示“或”</td>
</tr>
<tr>
<td align="center">？</td>
<td align="left">表示前面的字符至多出现1次的情况</td>
<td></td>
</tr>
</tbody></table>
<h2 id="最常用"><a href="#最常用" class="headerlink" title="最常用"></a>最常用</h2><p>查看配置文件时去除所有的注释和空行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># grep -Ev &quot;^#|^$&quot; /etc/ssh/sshd_config</span></span><br></pre></td></tr></table></figure>

<p>这里解释下：</p>
<p><code>grep -Ev &quot;^#|^$&quot; /etc/ssh/sshd_config</code> 是一个Linux命令，用于从<code>/etc/ssh/sshd_config</code>文件中筛选出非注释行和非空行。这里使用了<code>grep</code>命令，结合正则表达式和选项来实现这一目标。</p>
<ul>
<li><p><code>grep</code>: 是一个强大的文本搜索工具，用于搜索文件中的特定模式。</p>
</li>
<li><p><code>-E</code>: 告诉<code>grep</code>使用扩展正则表达式（Extended Regular Expression）。这允许使用更高级的正则表达式语法。</p>
</li>
<li><p><code>-v</code>: 表示反向选择，即选择不匹配指定模式的行。</p>
</li>
<li><pre><code>&quot;^#|^$&quot;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  : 是一个扩展正则表达式，它匹配两种类型的行：</span><br><span class="line"></span><br><span class="line">  - `^#`: 以`#`字符开头的行，这通常是注释行。</span><br><span class="line">  - `^$`: 空行，即只包含行首和行尾的行。</span><br><span class="line"></span><br><span class="line">- `/etc/ssh/sshd_config`: 是要搜索的文件路径，该文件通常包含SSH服务器的配置选项。</span><br><span class="line"></span><br><span class="line">因此，`grep -Ev &quot;^#|^$&quot; /etc/ssh/sshd_config`这个命令的作用是从`/etc/ssh/sshd_config`文件中筛选出所有非注释行和非空行，并将这些行输出到终端。这样，你可以更容易地查看和编辑SSH服务器的实际配置选项，而不必被注释和空行所干扰。</span><br><span class="line"></span><br><span class="line">~~~</span><br><span class="line">sed &#x27;/^\s*#/d; /^\s*$/d&#x27; filename | grep -v &#x27;^$&#x27;</span><br><span class="line">~~~</span><br><span class="line"></span><br><span class="line">`sed &#x27;/^\s*#/d; /^\s*$/d&#x27; filename | grep -v &#x27;^$&#x27;` 是一个在Linux shell中使用的命令组合，用于处理文本文件并输出特定的内容。这个命令组合的目的是从文件中去除所有的注释行和空行。下面我逐一解释每个部分的作用：</span><br><span class="line"></span><br><span class="line">`sed` 是一个流编辑器，用于对输入流（或文件）进行基本的文本转换。在这个命令中，`sed` 接收两个正则表达式作为编辑命令，并应用于文件 `filename`。</span><br><span class="line"></span><br><span class="line">1. `/^\s*#/d`：这个命令告诉 `sed` 删除所有以零个或多个空白字符（`\s*`）开头，后面紧跟一个 `#` 符号的行。这通常用于删除以 `#` 开头的注释行。</span><br><span class="line">2. `/^\s*$/d`：这个命令告诉 `sed` 删除所有只包含零个或多个空白字符的行。这用于删除空行。</span><br><span class="line"></span><br><span class="line">`grep` 是一个强大的文本搜索工具，用于搜索特定的模式。在这里，`-v` 选项表示“反向选择”，即选择不匹配指定模式的行。</span><br><span class="line"></span><br><span class="line">`&#x27;^$&#x27;` 是一个正则表达式，匹配只包含行首和行尾的行，即空行。因此，`grep -v &#x27;^$&#x27;` 会从输入中排除所有空行。</span><br><span class="line"></span><br><span class="line">将 `sed` 和 `grep` 命令通过管道 `|` 连接起来，可以首先使用 `sed` 删除注释和空行，然后使用 `grep` 进一步删除可能由 `sed` 留下的任何额外的空行。这通常用于确保输出中没有空行。</span><br><span class="line"></span><br><span class="line">综合来说，`sed &#x27;/^\s*#/d; /^\s*$/d&#x27; filename | grep -v &#x27;^$&#x27;` 这个命令组合会从 `filename` 文件中删除所有的注释行和空行，并将结果输出到终端。</span><br><span class="line"></span><br><span class="line"># Linux三剑客之sed</span><br><span class="line"></span><br><span class="line">Linux sed命令是利用script来处理文本文件。</span><br><span class="line"></span><br><span class="line">sed可依照script的指令，来处理、编辑文本文件。</span><br><span class="line"></span><br><span class="line">sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</span><br><span class="line"></span><br><span class="line">## 语法</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">sed的命令格式： sed [option] &#x27;sed command&#x27; filename</span><br><span class="line">sed的脚本格式：sed [option] ‐f &#x27;sed script&#x27; filename</span><br><span class="line">常用选项：</span><br><span class="line">‐n ：只打印模式匹配的行</span><br><span class="line">‐e ：直接在命令行模式上进行sed动作编辑，此为默认选项</span><br><span class="line">‐f ：将sed的动作写在一个文件内，用–f filename 执行filename内的sed动作</span><br><span class="line">‐r ：支持扩展表达式</span><br><span class="line">‐i ：直接修改文件内容</span><br><span class="line">查询文本的方式</span><br><span class="line">使用行号和行号范围</span><br><span class="line">x：行号</span><br><span class="line">x,y：从x行到y行</span><br><span class="line">x,y!：x行到y行之外</span><br><span class="line">/pattern：查询包含模式的行</span><br><span class="line">/pattern/, /pattern/：查询包含两个模式的行</span><br><span class="line">/pattern/,x：x行内查询包含模式的行</span><br><span class="line">x,/pattern/：x行后查询匹配模式的行</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<h2 id="动作说明"><a href="#动作说明" class="headerlink" title="动作说明"></a>动作说明</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">常用选项：</span><br><span class="line">p：打印匹配的行(‐n)</span><br><span class="line">=：显示文件行号</span><br><span class="line">a\：指定行号后添加新文本</span><br><span class="line">i\：指定行号前添加新文本</span><br><span class="line">d：删除定位行</span><br><span class="line">c\：用新文本替换定位文本</span><br><span class="line">w filename：写文本到一个文件</span><br><span class="line">r filename：从另一个文件读文本</span><br><span class="line">s///：替换</span><br><span class="line">替换标记：</span><br><span class="line">g：行内全局替换</span><br><span class="line">p：显示替换成功的行</span><br><span class="line">w：将替换成功的结果保存至指定文件</span><br><span class="line">q：第一个模式匹配后立即退出</span><br><span class="line">&#123;&#125;：在定位行执行的命令组，用逗号分隔</span><br><span class="line">g：将模式2粘贴到/pattern n/</span><br></pre></td></tr></table></figure>

<p>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)</p>
<p>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</p>
<p>d ：删除，因为是删除啊，所以 d 后面通常不接任何东西；</p>
<p>i ：插入， i的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</p>
<p>p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行</p>
<p>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s&#x2F;old&#x2F;new&#x2F;g 就是啦！</p>
<h2 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h2><p>在testfile文件的第四行后添加一行，并将结果输出到标准输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># sed -e 4a\newline test</span></span><br><span class="line">line one</span><br><span class="line">line two</span><br><span class="line">line three</span><br><span class="line">line four</span><br><span class="line">newline</span><br><span class="line">line five</span><br></pre></td></tr></table></figure>

<h3 id="以行为单位的新增-删除（nl是个整体，不可分割）"><a href="#以行为单位的新增-删除（nl是个整体，不可分割）" class="headerlink" title="以行为单位的新增&#x2F;删除（nl是个整体，不可分割）"></a>以行为单位的新增&#x2F;删除（nl是个整体，不可分割）</h3><p>将 &#x2F;etc&#x2F;passwd 的内容列出并且列印行号，同时，请将第 2~5 行删除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2,5d&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>sed 的动作为 ‘2,5d’ ，那个 d 就是删除！因为 2-5 行给他删除了，所以显示的数据就没有 2-5 行罗～ 另外，注意一下，原本应该是要下达 sed -e 才对，没有 -e 也行啦！同时也要注意的是， sed 后面接的动作，请务必以 ‘’ 两个单引号括住喔！</p>
<p>只要删除第 2 行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2d&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>要删除第 3 到最后一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;3,$d&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>在第二行后(亦即是加在第三行)加上『hello world』字样</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2a\hello world&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">hello world</span><br><span class="line">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>加在第二行前面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2i\hello world&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">hello world</span><br><span class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>增加多行文字</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2a\hello world\</span></span><br><span class="line">&gt; nihao<span class="string">&#x27;</span></span><br><span class="line"><span class="string">     1  root:x:0:0:root:/root:/bin/bash</span></span><br><span class="line"><span class="string">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span></span><br><span class="line"><span class="string">hello world</span></span><br><span class="line"><span class="string">nihao</span></span><br><span class="line"><span class="string">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span></span><br><span class="line"><span class="string">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</span></span><br><span class="line"><span class="string">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span></span><br><span class="line"><span class="string">     6  sync:x:5:0:sync:/sbin:/bin/sync</span></span><br><span class="line"><span class="string">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span></span><br><span class="line"><span class="string">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span></span><br><span class="line"><span class="string">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span></span><br><span class="line"><span class="string">    10  operator:x:11:0:operator:/root:/sbin/nologin</span></span><br><span class="line"><span class="string">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span></span><br><span class="line"><span class="string">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span></span><br><span class="line"><span class="string">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span></span><br><span class="line"><span class="string">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span></span><br><span class="line"><span class="string">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span></span><br><span class="line"><span class="string">    16  polkitd:x:999:998:User for polkitd:/:/sbin/nologin</span></span><br><span class="line"><span class="string">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span></span><br><span class="line"><span class="string">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span></span><br></pre></td></tr></table></figure>

<h3 id="以行为单位的替换与显示"><a href="#以行为单位的替换与显示" class="headerlink" title="以行为单位的替换与显示"></a>以行为单位的替换与显示</h3><p>将第2-5行的内容取代成为『No 2-5 number』</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;2,5c\No 2-5 number&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">No 2-5 number</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>仅列出 &#x2F;etc&#x2F;passwd 文件内的第 5-7 行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n &#x27;5,7p&#x27;</span></span><br><span class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br></pre></td></tr></table></figure>

<h3 id="数据的搜寻并显示"><a href="#数据的搜寻并显示" class="headerlink" title="数据的搜寻并显示"></a>数据的搜寻并显示</h3><p>搜索 &#x2F;etc&#x2F;passwd有root关键字的行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n &#x27;/root/p&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/bash</span><br><span class="line">    10  operator:x:11:0:operator:/root:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h3 id="数据的搜寻并删除"><a href="#数据的搜寻并删除" class="headerlink" title="数据的搜寻并删除"></a>数据的搜寻并删除</h3><p>删除&#x2F;etc&#x2F;passwd所有包含root的行，其他行输出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed &#x27;/root/d&#x27;</span></span><br><span class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">     3  daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">     4  adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">     5  lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">     6  <span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">     7  shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">     8  halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">     9  mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">    11  games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">    12  ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">    13  nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="line">    14  systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="line">    15  dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">    16  polkitd:x:999:998:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">    17  sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">    18  postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></pre></td></tr></table></figure>

<h3 id="数据的搜寻并执行命令"><a href="#数据的搜寻并执行命令" class="headerlink" title="数据的搜寻并执行命令"></a>数据的搜寻并执行命令</h3><p>搜索&#x2F;etc&#x2F;passwd,找到root对应的行，执行后面花括号中的一组命令，每个命令之间用分号分隔，这里把bash替换为blueshell，再输出这行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -n &#x27;/root/&#123;s/bash/blueshell/p;q&#125;&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/blueshell</span><br></pre></td></tr></table></figure>

<p>最后的q是退出，不然会继续找下去</p>
<h3 id="数据的搜寻并替换"><a href="#数据的搜寻并替换" class="headerlink" title="数据的搜寻并替换"></a>数据的搜寻并替换</h3><p>除了整行的处理模式之外， sed 还可以用行为单位进行部分数据的搜寻并取代</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/要被取代的字串/新的字串/g&#x27;</span></span><br></pre></td></tr></table></figure>

<p>查询 IP</p>
<p>原始信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">yum -y install net-tools</span><br><span class="line">[root@localhost ~]<span class="comment"># ifconfig</span></span><br><span class="line">ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.91.128  netmask 255.255.255.0  broadcast 192.168.91.255</span><br><span class="line">        inet6 fe80::2de4:b37a:36e9:ae2e  prefixlen 64  scopeid 0x20&lt;<span class="built_in">link</span>&gt;</span><br><span class="line">        ether 00:0c:29:d3:76:83  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 33461  bytes 32133707 (30.6 MiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 11322  bytes 1300148 (1.2 MiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 10  bytes 697 (697.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 10  bytes 697 (697.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<p>取有IP地址那一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ifconfig | sed -n &#x27;/netmask/p&#x27;</span></span><br><span class="line">        inet 192.168.91.128  netmask 255.255.255.0  broadcast 192.168.91.255</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br></pre></td></tr></table></figure>

<p>注：<code>-n</code> 选项告诉 <code>sed</code> 不要输出任何内容，除非明确指定要输出。</p>
<p><code>/netmask/p</code> 是一个 <code>sed</code> 命令，它告诉 <code>sed</code> 查找包含“netmask”的行，并打印（<code>p</code>）这些行。</p>
<p>删除IP地址前面和后面的东西</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ifconfig | sed -n &#x27;/netmask/p&#x27; | sed &#x27;s/^.*inet //g&#x27; | sed &#x27;s/  netmask.*$//g&#x27;</span></span><br><span class="line">192.168.91.128 </span><br><span class="line">127.0.0.1</span><br></pre></td></tr></table></figure>

<p>注：</p>
<ol>
<li><strong><code>ifconfig</code></strong>:</li>
</ol>
<p><code>ifconfig</code> 命令用于显示或配置网络接口的参数。当你运行 <code>ifconfig</code>，它会列出所有网络接口及其相关的配置信息，如IP地址、子网掩码等。</p>
<ol>
<li><strong><code>sed -n &#39;/netmask/p&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令用于从 <code>ifconfig</code> 的输出中筛选出包含 “netmask” 的行。<code>-n</code> 选项告诉 <code>sed</code> 默认不输出任何内容，而 <code>/netmask/p</code> 则指定只打印包含 “netmask” 的行。</p>
<ol>
<li><strong><code>sed &#39;s/^.\*inet //g&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令用于处理上一步输出的行。<code>s/^.*inet //g</code> 是一个替换命令，它的作用是将每行中从开头到 “inet “ 的部分替换为空（即删除）。这通常用于从 <code>ifconfig</code> 的输出中提取IP地址，因为IP地址通常紧跟在 “inet “ 后面。</p>
<ol>
<li><strong><code>sed &#39;s/ netmask.\*$//g&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令进一步处理上一步的输出。<code>s/ netmask.*$//g</code> 也是一个替换命令，它的作用是将每行中从 “ netmask” 开始到行尾的部分替换为空（即删除）。这用于删除IP地址后面的子网掩码和其他相关信息，只保留IP地址本身。</p>
<p>综合以上步骤，整个命令组合的作用是从 <code>ifconfig</code> 的输出中提取每个网络接口的IP地址。不过，需要注意的是，现代Linux发行版可能推荐使用 <code>ip</code> 命令来替代 <code>ifconfig</code>，因为 <code>ifconfig</code> 在某些系统中可能已经被标记为过时或不再维护。如果你使用的是较新的Linux系统，建议考虑使用 <code>ip</code> 命令来提取IP地址。</p>
<p>取第一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ifconfig | sed -n &#x27;/netmask/p&#x27; | sed &#x27;s/^.*inet //g&#x27; | sed &#x27;s/  netmask.*$//g&#x27; | sed -n &#x27;1p&#x27;</span></span><br><span class="line">192.168.91.128</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-n</code>：这个选项告诉 <code>sed</code> 不要输出任何内容，除非明确指定。通常与 <code>p</code> 命令一起使用，以仅输出匹配的行。</li>
<li><code>&#39;1p&#39;</code>：这是一个 <code>sed</code> 脚本，它告诉 <code>sed</code> 打印（<code>p</code>）第一行（<code>1</code>）。</li>
</ul>
<p>可以在末尾加g替换每一个匹配的关键字,否则只替换每行的第一个</p>
<p>另一种方式：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ip a|sed -n &#x27;/inet /p&#x27;|sed &#x27;s/^.*inet //g&#x27;|sed &#x27;s/\/.*$//g&#x27;|sed -n &#x27;2p&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这个命令组合使用 <code>ip</code>, <code>sed</code> 等命令来提取特定网络接口（通常是第二个网络接口）的IP地址。这里是对命令的逐步解释：</p>
<ol>
<li><strong><code>ip a</code></strong>:</li>
</ol>
<p>这个命令是 <code>ip address</code> 的简写，用于显示所有网络接口的地址信息。输出通常会包括接口的名称、IP地址、子网掩码、广播地址等。</p>
<ol start="2">
<li><strong><code>sed -n &#39;/inet /p&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令用于从 <code>ip a</code> 的输出中筛选出包含 “inet “ 的行。<code>-n</code> 选项告诉 <code>sed</code> 默认不输出任何内容，而 <code>/inet /p</code> 则指定只打印包含 “inet “ 的行。这通常用于提取IPv4地址。</p>
<ol start="3">
<li><strong><code>sed &#39;s/^.\*inet //g&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令用于处理上一步输出的行。<code>s/^.*inet //g</code> 是一个替换命令，它的作用是将每行中从开头到 “inet “ 的部分替换为空（即删除）。这用于从 <code>ip a</code> 的输出中提取出 “inet “ 后面的部分，通常是IP地址。</p>
<ol start="4">
<li><strong><code>sed &#39;s/\/.\*$//g&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令进一步处理上一步的输出。<code>s/\/.*$//g</code> 是一个替换命令，它的作用是将每行中从 “&#x2F;“（子网掩码的开始）到行尾的部分替换为空（即删除）。这用于从IP地址和子网掩码的组合中只保留IP地址。</p>
<ol start="5">
<li><strong><code>sed -n &#39;2p&#39;</code></strong>:</li>
</ol>
<p>这个 <code>sed</code> 命令用于输出处理后的第二行。这通常用于提取第二个网络接口的IP地址，因为 <code>ip a</code> 的输出中，第一个网络接口（通常是 <code>lo</code>，即回环接口）通常位于列表的顶部。</p>
<p>综合以上步骤，整个命令组合的作用是提取系统中第二个网络接口的IPv4地址。</p>
<p>需要注意的是，这个命令组合假设 <code>ip a</code> 的输出中第二个包含 “inet “ 的行对应于第二个网络接口的IP地址。在大多数情况下，这是正确的，但如果系统配置不同，可能需要调整命令以适应特定情况。</p>
<h3 id="多点编辑"><a href="#多点编辑" class="headerlink" title="多点编辑"></a>多点编辑</h3><p>一条sed命令，删除&#x2F;etc&#x2F;passwd第三行到末尾的数据，并把bash替换为blueshell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd | sed -e &#x27;3,$d&#x27; -e &#x27;s/bash/blueshell/&#x27;</span></span><br><span class="line">     1  root:x:0:0:root:/root:/bin/blueshell</span><br><span class="line">     2  bin:x:1:1:bin:/bin:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>-e表示多点编辑，第一个编辑命令删除&#x2F;etc&#x2F;passwd第三行到末尾的数据，第二条命令搜索bash替换为blueshell。</p>
<p>注：这个命令组合做了几件事情。让我们逐步分析它：</p>
<ol>
<li><strong>nl &#x2F;etc&#x2F;passwd</strong></li>
</ol>
<p><code>nl</code> 命令用于给文件的每一行加上行号。在这里，它会给 <code>/etc/passwd</code> 文件的每一行加上行号。<code>/etc/passwd</code> 文件通常包含系统用户的账户信息。</p>
<ol start="2">
<li><strong>sed -e ‘3,$d’ -e ‘s&#x2F;bash&#x2F;blueshell&#x2F;‘</strong></li>
</ol>
<p><code>sed</code> 是一个流编辑器，用于对输入流（或文件）进行基本的文本转换。</p>
<p><code>-e</code> 选项允许你指定一个或多个 <code>sed</code> 编辑命令。</p>
<ul>
<li><code>&#39;3,$d&#39;</code>: 这个命令告诉 <code>sed</code> 删除从第3行到最后一行的所有内容。<code>3,$</code> 是一个地址范围，其中 <code>3</code> 是起始行号，<code>$</code> 表示最后一行。<code>d</code> 是一个命令，表示删除匹配的行。</li>
<li><code>&#39;s/bash/blueshell/&#39;</code>: 这是一个替换命令，它告诉 <code>sed</code> 将每一行中的第一个 “bash” 替换为 “blueshell”。</li>
</ul>
<p>需要注意的是，这两个 <code>sed</code> 命令是顺序执行的。首先，所有从第3行到最后一行的内容都会被删除。然后，在剩下的内容中，所有的 “bash” 都会被替换为 “blueshell”。</p>
<p>因此，整个命令组合 <code>nl /etc/passwd | sed -e &#39;3,$d&#39; -e &#39;s/bash/blueshell/&#39;</code> 的作用是：</p>
<ol>
<li>给 <code>/etc/passwd</code> 文件的每一行加上行号。</li>
<li>删除从第3行到最后一行的所有内容。</li>
<li>在剩下的内容中，将所有的 “bash” 替换为 “blueshell”。</li>
</ol>
<p>最终，你会看到 <code>/etc/passwd</code> 文件的前两行（带有行号），并且如果这两行中有 “bash” 的话，它会被替换为 “blueshell”。</p>
<h3 id="直接修改文件内容-危险动作"><a href="#直接修改文件内容-危险动作" class="headerlink" title="直接修改文件内容(危险动作)"></a>直接修改文件内容(危险动作)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat test </span></span><br><span class="line">line one.</span><br><span class="line">line two.</span><br><span class="line">line three.</span><br><span class="line">line four.</span><br><span class="line">line five.</span><br></pre></td></tr></table></figure>

<p>加i参数就是直接修改</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># sed -i &#x27;s/ \.$ / \! /g&#x27; test </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat test </span></span><br><span class="line">line one!</span><br><span class="line">line two!</span><br><span class="line">line three!</span><br><span class="line">line four!</span><br><span class="line">line five!</span><br></pre></td></tr></table></figure>

<p>注：这个 <code>sed</code> 命令做了以下事情：</p>
<ol>
<li><code>-i</code>: 这个选项告诉 <code>sed</code> 直接修改输入文件，而不是将结果输出到标准输出（通常是终端）。</li>
<li><code>&#39;s/ \.$ / \! /g&#39;</code>: 这是一个 <code>sed</code> 替换命令，其格式是 <code>s/pattern/replacement/flags</code>。<ul>
<li><code>\.</code>: 匹配一个实际的点字符（<code>.</code>）。因为在正则表达式中，<code>.</code> 是一个特殊字符，表示匹配任何字符（除了换行符）。所以，为了匹配实际的点字符，我们需要使用反斜杠 <code>\</code> 来转义它。</li>
<li><code>$</code>: 匹配行的结尾。</li>
<li><code>\.$</code>: 因此，<code>\.$</code> 匹配以点字符结尾的行。</li>
<li><code>\!</code>: 这是替换字符串，表示将匹配到的点字符替换为感叹号 <code>!</code>。</li>
<li><code>g</code>: 这是一个全局标志，表示替换每一行中所有匹配到的模式，而不仅仅是每一行的第一个匹配。</li>
</ul>
</li>
</ol>
<p>综上所述，这个 <code>sed</code> 命令会在文件 <code>test</code> 中查找所有以点字符结尾的行，并将这些点字符替换为感叹号。</p>
<p>例如，如果 <code>test</code> 文件的内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This is a line.  </span><br><span class="line">Another line without a dot.  </span><br><span class="line">This line ends with a dot.</span><br></pre></td></tr></table></figure>

<p>运行这个 <code>sed</code> 命令后，<code>test</code> 文件的内容将变为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This is a line!  </span><br><span class="line">Another line without a dot!</span><br><span class="line">This line ends with a dot!</span><br></pre></td></tr></table></figure>

<p>注意：使用 <code>-i</code> 选项时要小心，因为它会直接修改文件。如果你不确定结果是否正确，可以先不使用 <code>-i</code> 选项来查看结果，然后再决定是否直接修改文件。</p>
<p>\利用 sed 直接在最后一行加入 # test</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># sed -i &#x27;$a\# test&#x27; test </span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat test </span></span><br><span class="line">line one!</span><br><span class="line">line two!</span><br><span class="line">line three!</span><br><span class="line">line four!</span><br><span class="line">line five!</span><br><span class="line"><span class="comment"># test</span></span><br></pre></td></tr></table></figure>

<p>注：</p>
<ol>
<li><code>-i</code>: 如之前所述，这个选项告诉 <code>sed</code> 直接修改输入文件，而不是将结果输出到标准输出。</li>
<li><code>&#39;$a\# test&#39;</code>: 这是一个 <code>sed</code> 命令，用于在文件的最后一行之后追加文本。<ul>
<li><code>$</code>: 这是一个地址，表示文件的最后一行。</li>
<li><code>a</code>: 这是一个命令，表示在指定的地址之后追加文本。</li>
<li><code># test</code>: 这是要追加的文本内容。</li>
</ul>
</li>
</ol>
<h1 id="Linux三剑客之awk"><a href="#Linux三剑客之awk" class="headerlink" title="Linux三剑客之awk"></a>Linux三剑客之awk</h1><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;pattern + action&#125;&#x27;</span> &#123;filenames&#125;</span><br></pre></td></tr></table></figure>

<p>其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花括号（{}）不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。 pattern就是要表示的正则表达式，用斜杠括起来。</p>
<p>awk语言的最基本功能是在文件或者字符串中基于指定规则浏览和抽取信息，awk抽取信息后，才能进行其他文本操作。完整的awk脚本通常用来格式化文本文件中的信息。</p>
<p>通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本。</p>
<h2 id="awk-的原理"><a href="#awk-的原理" class="headerlink" title="awk 的原理"></a>awk 的原理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># awk -F: &#x27;&#123;print $0&#125;&#x27; /etc/passwd</span></span><br></pre></td></tr></table></figure>

<p>执行 awk 时，它依次对&#x2F;etc&#x2F;passwd 中的每一行执行 print 命令。</p>
<p><img src="/BLOG/source/images/2.jpg" alt="2"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># awk -F&quot;:&quot; &#x27;&#123;print $1&#125;&#x27; /etc/passwd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># awk -F&quot;:&quot; &#x27;&#123;print $1 $3&#125;&#x27; /etc/passwd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># awk -F&quot;:&quot; &#x27;&#123;print $1&quot; &quot; $3&#125;&#x27; /etc/passwd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># awk -F&quot;:&quot; &#x27;&#123;print &quot;username:&quot;$1&quot;\t\tuid:&quot; $3&#125;&#x27; /etc/passwd</span></span><br></pre></td></tr></table></figure>

<p>-F参数：指定分隔符，可指定一个或多个</p>
<p>print 后面做字符串的拼接</p>
<table>
<thead>
<tr>
<th>变量名</th>
<th>属性</th>
</tr>
</thead>
<tbody><tr>
<td>$0</td>
<td>当前记录</td>
</tr>
<tr>
<td>$1~$n</td>
<td>当前记录的第n个字段</td>
</tr>
<tr>
<td>FS</td>
<td>输入字段分割符 默认是空格</td>
</tr>
<tr>
<td>RS</td>
<td>输入记录分割符 默认为换行符</td>
</tr>
<tr>
<td>NF</td>
<td>当前记录中的字段个数，就是有多少列</td>
</tr>
<tr>
<td>NR</td>
<td>已经读出的记录数，就是行号，从1开始</td>
</tr>
<tr>
<td>OFS</td>
<td>输出字段分割符 默认也是空格</td>
</tr>
<tr>
<td>ORS</td>
<td>输出的记录分割符 默认为换行符</td>
</tr>
</tbody></table>
<p>注：内置变量很多，参阅相关资料</p>
<h3 id="实例一：只查看test-txt文件（100行）内第20到第30行的内容（企业面试）"><a href="#实例一：只查看test-txt文件（100行）内第20到第30行的内容（企业面试）" class="headerlink" title="实例一：只查看test.txt文件（100行）内第20到第30行的内容（企业面试）"></a>实例一：只查看test.txt文件（100行）内第20到第30行的内容（企业面试）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># seq 100 &gt; test.txt</span></span><br><span class="line">[root@localhost ~]<span class="comment"># awk &#x27;&#123;if(NR&gt;=20 &amp;&amp; NR&lt;=30) print $1&#125;&#x27; test.txt </span></span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">[root@localhost ~]<span class="comment"># nl /etc/passwd|tail -n +20|head -n 10</span></span><br></pre></td></tr></table></figure>

<h3 id="实例二：已知test-txt文件内容为"><a href="#实例二：已知test-txt文件内容为" class="headerlink" title="实例二：已知test.txt文件内容为"></a>实例二：已知test.txt文件内容为</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat test.txt </span></span><br><span class="line">I am aaron, my qq is 1234567</span><br></pre></td></tr></table></figure>

<p>请从该文件中过滤出’aaron’字符串与1234567，最后输出的结果为：aaron 1234567</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># awk -F &#x27;[ ,]+&#x27; &#x27;&#123;print $3&quot; &quot;$NF&#125;&#x27; test.txt  #用[]可以放多个分隔符</span></span><br><span class="line">aaron 1234567</span><br><span class="line">等效</span><br><span class="line">[root@localhost ~]<span class="comment"># awk -F &#x27;,&#x27; &#x27;&#123;print $1&quot; &quot;$2&#125;&#x27; test.txt|awk &#x27;&#123;print $3 &quot; &quot; $NF&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="BEGIN-和-END-模块"><a href="#BEGIN-和-END-模块" class="headerlink" title="BEGIN 和 END 模块"></a>BEGIN 和 END 模块</h2><p>BEGIN只执行一次并且执行在主体代码块之前。</p>
<p>END只执行一次并且执行在主体代码块之后。</p>
<p>BEGIN可以抛开文件单独执行，结果类似于echo而END不可以。</p>
<p>BEGIN中没有文件的读取变量而END是有的。但END中的$0是awk处理到最后的文本样式。</p>
<h3 id="实例一：统计-etc-passwd的账户人数"><a href="#实例一：统计-etc-passwd的账户人数" class="headerlink" title="实例一：统计&#x2F;etc&#x2F;passwd的账户人数"></a>实例一：统计&#x2F;etc&#x2F;passwd的账户人数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;BEGIN &#123;count=0;print &quot;[start] user count is &quot;count&#125;&#123;count++;print $0&#125; END&#123;print &quot;[end] user count is &quot;count&#125;&#x27;</span> /etc/passwd</span><br></pre></td></tr></table></figure>

<p>count是自定义变量。之前的action{}里都是只有一个print,其实print只是一个语句，而action{}可以有多个语句，以;号隔开。这里没有初始化count，虽然默认是0，但是妥当的做法还是初始化为0</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># awk &#x27;&#123;count++;print $0;&#125; END&#123;print &quot;user count is &quot;count&#125;&#x27; /etc/passwd</span></span><br></pre></td></tr></table></figure>

<h3 id="实例二：统计某个文件夹下的文件占用的字节数"><a href="#实例二：统计某个文件夹下的文件占用的字节数" class="headerlink" title="实例二：统计某个文件夹下的文件占用的字节数"></a>实例二：统计某个文件夹下的文件占用的字节数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ll | awk &#x27;BEGIN &#123;size=0&#125; &#123;size=size+$5&#125; END&#123;print &quot;size is &quot;,size&#125;&#x27;</span></span><br><span class="line">size is  1468</span><br><span class="line">[root@localhost ~]<span class="comment"># ll | awk &#x27;BEGIN &#123;size=0&#125; &#123;size=size+$5&#125; END&#123;print &quot;size is &quot;,size/1024/1024,&quot;M&quot;&#125;&#x27;</span></span><br><span class="line">size is  0.00139999 M</span><br></pre></td></tr></table></figure>

<h2 id="awk运算符"><a href="#awk运算符" class="headerlink" title="awk运算符"></a>awk运算符</h2><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>赋值运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>&#x3D; +&#x3D; -&#x3D; *&#x3D; &#x2F;&#x3D; %&#x3D; ^&#x3D; **&#x3D;</td>
<td>赋值语句</td>
<td></td>
<td></td>
</tr>
<tr>
<td>逻辑运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>\</td>
<td>\</td>
<td></td>
<td>逻辑或</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>逻辑与</td>
<td></td>
<td></td>
</tr>
<tr>
<td>正则运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>~ !~</td>
<td>匹配正则表达式和不匹配正则表达式</td>
<td></td>
<td></td>
</tr>
<tr>
<td>关系运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>&lt; &lt;&#x3D; &gt; &gt;&#x3D; !&#x3D; &#x3D;&#x3D;</td>
<td>关系运算符</td>
<td></td>
<td></td>
</tr>
<tr>
<td>算数运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>+ -</td>
<td>加,减</td>
<td></td>
<td></td>
</tr>
<tr>
<td>* &#x2F; &amp;</td>
<td>乘,除与求余</td>
<td></td>
<td></td>
</tr>
<tr>
<td>+ - !</td>
<td>一元加,减和逻辑非</td>
<td></td>
<td></td>
</tr>
<tr>
<td>^ ***</td>
<td>求幂</td>
<td></td>
<td></td>
</tr>
<tr>
<td>++ –</td>
<td>增加或减少，作为前缀或后缀</td>
<td></td>
<td></td>
</tr>
<tr>
<td>其他运算符</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>$</td>
<td>字段引用</td>
<td></td>
<td></td>
</tr>
<tr>
<td>空格</td>
<td>字符串链接符</td>
<td></td>
<td></td>
</tr>
<tr>
<td>?:</td>
<td>三目运算符</td>
<td></td>
<td></td>
</tr>
<tr>
<td>in</td>
<td>数组中是否存在某键值</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>awk 赋值运算符：a+&#x3D;5;等价于： a&#x3D;a+5;其他同类</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=5;a+=5;print a&#125;&#x27;</span></span><br><span class="line">10</span><br></pre></td></tr></table></figure>

<p>awk逻辑运算符：判断表达式 a&gt;2&amp;&amp;b&gt;1为真还是为假，后面的表达式同理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=1;b=2;print (a&gt;2&amp;&amp;b&gt;1,a=1||b&gt;1)&#125;&#x27;</span></span><br><span class="line">0 1</span><br></pre></td></tr></table></figure>

<p>awk正则运算符：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;100testaa&quot;;if(a~/100/) &#123;print &quot;OK&quot;&#125;else &#123;print &quot;NO&quot;&#125;&#125;&#x27;</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>关系运算符：</p>
<p>如： &gt; &lt; 可以作为字符串比较，也可以用作数值比较，关键看操作数如果是字符串就会转换为字符串比较。两个都为数字才转为数值比较。字符串比较：按照ascii码顺序比较。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;11&quot;;if(a&gt;=9)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span></span><br><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=11;if(a&gt;=9)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span></span><br><span class="line">OK</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a;if(a&gt;=b)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>awk 算术运算符：</p>
<p>说明，所有用作算术运算符进行操作，操作数自动转为数值，所有非数值都变为0。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a++,++a&#125;&#x27;</span></span><br><span class="line">0 2</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;20b4&quot;;print a++,++a&#125;&#x27;</span></span><br><span class="line">20 22</span><br></pre></td></tr></table></figure>

<p>这里的a++ , ++a与javascript语言一样：a++是先赋值加++；++a是先++再赋值</p>
<p>三目运算符 ?:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a==&quot;b&quot;?&quot;ok&quot;:&quot;err&quot;&#125;&#x27;</span></span><br><span class="line">ok</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a==&quot;c&quot;?&quot;ok&quot;:&quot;err&quot;&#125;&#x27;</span></span><br><span class="line">err</span><br></pre></td></tr></table></figure>

<h2 id="常用-awk-内置变量"><a href="#常用-awk-内置变量" class="headerlink" title="常用 awk 内置变量"></a>常用 awk 内置变量</h2><table>
<thead>
<tr>
<th>变量名</th>
<th>属性</th>
</tr>
</thead>
<tbody><tr>
<td>$0</td>
<td>当前记录</td>
</tr>
<tr>
<td>$1~$n</td>
<td>当前记录的第n个字段</td>
</tr>
<tr>
<td>FS</td>
<td>输入字段分割符 默认是空格</td>
</tr>
<tr>
<td>RS</td>
<td>输入记录分割符 默认为换行符</td>
</tr>
<tr>
<td>NF</td>
<td>当前记录中的字段个数，就是有多少列</td>
</tr>
<tr>
<td>NR</td>
<td>已经读出的记录数，就是行号，从1开始</td>
</tr>
<tr>
<td>OFS</td>
<td>输出字段分割符 默认也是空格</td>
</tr>
<tr>
<td>ORS</td>
<td>输出的记录分割符 默认为换行符</td>
</tr>
</tbody></table>
<p>注：内置变量很多，参阅相关资料</p>
<p>字段分隔符 FS</p>
<p>FS&#x3D;”\t” 一个或多个 Tab 分隔</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># cat tab.txt </span></span><br><span class="line">aa  bb      cc</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;FS=&quot;\t+&quot;&#125;&#123;print $1,$2,$3&#125;&#x27; tab.txt </span></span><br><span class="line">aa bb cc</span><br></pre></td></tr></table></figure>

<p>FS&#x3D;”[[:space:]+]” 一个或多个空白空格，默认的，匹配到不符合的就停止</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk -F [[:space:]+] &#x27;&#123;print $1,$2,$3,$4,$5&#125;&#x27; tab.txt </span></span><br><span class="line">aa bb   cc</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk -F [[:space:]+] &#x27;&#123;print $1,$2&#125;&#x27; tab.txt </span></span><br><span class="line">aa bb</span><br></pre></td></tr></table></figure>

<p>FS&#x3D;”[“ “]+” 以一个或多个空格或：分隔</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk -F [&quot; &quot;]+ &#x27;&#123;print $1,$2,$3&#125;&#x27; hello.txt </span></span><br><span class="line">root x 0</span><br></pre></td></tr></table></figure>

<p>字段数量 NF :显示满足用:分割，并且有8个字段的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk -F &quot;:&quot; &#x27;NF==8&#123;print $0&#125;&#x27; hello.txt </span></span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin:888</span><br></pre></td></tr></table></figure>

<p>记录数量 NR</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># ifconfig ens33 | awk -F [&quot; &quot;]+ &#x27;NR==2&#123;print $3&#125;&#x27;</span></span><br><span class="line">192.168.175.10</span><br></pre></td></tr></table></figure>

<p>RS 记录分隔符变量</p>
<p>将 FS 设置成”\n”告诉 awk， 每个字段都占据一行。通过将 RS 设置成””，还会告诉 awk每个地址记录都由空白行分隔。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># cat awk.txt </span></span><br><span class="line"><span class="comment">#!/bin/awk</span></span><br><span class="line">BEGIN &#123;</span><br><span class="line">    FS=<span class="string">&quot;\n&quot;</span></span><br><span class="line">    RS=<span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="variable">$1</span><span class="string">&quot;,&quot;</span><span class="variable">$2</span><span class="string">&quot;,&quot;</span><span class="variable">$3</span></span><br><span class="line">&#125;</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk -f awk.txt recode.txt</span></span><br></pre></td></tr></table></figure>

<p>在””分割符之内，符合\n分割的会被打印出来</p>
<p>OFS 输出字段分隔符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;FS=&quot;:&quot;;OFS=&quot;#&quot;&#125;&#123;print $1,$2,$3&#125;&#x27; hello.txt </span></span><br><span class="line">root<span class="comment">#x#0</span></span><br><span class="line">bin<span class="comment">#x#1</span></span><br></pre></td></tr></table></figure>

<p>ORS 输出记录分隔符</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># cat awk.txt </span></span><br><span class="line"><span class="comment">#!/bin/awk</span></span><br><span class="line">BEGIN &#123;</span><br><span class="line">    FS=<span class="string">&quot;\n&quot;</span></span><br><span class="line">    RS=<span class="string">&quot;&quot;</span></span><br><span class="line">    ORS=<span class="string">&quot;\n\n&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="variable">$1</span><span class="string">&quot;,&quot;</span><span class="variable">$2</span><span class="string">&quot;,&quot;</span><span class="variable">$3</span></span><br><span class="line">&#125;</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk -f awk.txt recode.txt </span></span><br><span class="line">Jimmy the Weasel,100 Pleasant Drive,San Francisco,CA 123456</span><br><span class="line"></span><br><span class="line">Big Tony,200 Incognito Ave.,Suburbia,WA 64890</span><br></pre></td></tr></table></figure>

<h2 id="awk正则"><a href="#awk正则" class="headerlink" title="awk正则"></a>awk正则</h2><table>
<thead>
<tr>
<th>元字符</th>
<th>功能</th>
<th>示例</th>
<th>解释</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>首航定位符</td>
<td>&#x2F;^root&#x2F;</td>
<td>匹配所有以root开头的行</td>
<td></td>
<td></td>
</tr>
<tr>
<td>$ 行尾定位符 \</td>
<td>&#x2F;root$&#x2F;</td>
<td>匹配所有以root结尾的行</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>.</td>
<td>匹配任意单个字符</td>
<td>&#x2F;r..t&#x2F;</td>
<td>匹配字母r,然后两个任意字符，再以t结尾的行</td>
<td></td>
<td></td>
</tr>
<tr>
<td>*</td>
<td>匹配0个或多个前导字符(包括回车)</td>
<td>&#x2F;a*ool&#x2F;</td>
<td>匹配0个或多个a之后紧跟着ool的行，比如ool，aaaaool等</td>
<td></td>
<td></td>
</tr>
<tr>
<td>+</td>
<td>匹配1个或多个前导字符</td>
<td>&#x2F;a+b&#x2F;</td>
<td>ab, aaab</td>
<td></td>
<td></td>
</tr>
<tr>
<td>?</td>
<td>匹配0个或1个前导字符</td>
<td>&#x2F;a?b&#x2F;</td>
<td>b，ab</td>
<td></td>
<td></td>
</tr>
<tr>
<td>[]</td>
<td>匹配指定字符组内的任意一个字符</td>
<td>&#x2F;^[abc]&#x2F;</td>
<td>匹配以a或b或c开头的行</td>
<td></td>
<td></td>
</tr>
<tr>
<td>[^]</td>
<td>匹配不在指定字符组内任意一个字符</td>
<td>&#x2F;^[^abc]&#x2F;</td>
<td>匹配不以字母a或b或c开头的行</td>
<td></td>
<td></td>
</tr>
<tr>
<td>()</td>
<td>子表达式组合</td>
<td>&#x2F;(rool)+&#x2F;</td>
<td>表示一个或多个rool组合，当有一些字符需要组合时，使用括号括起来</td>
<td></td>
<td></td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>或者的意思</td>
<td>&#x2F;(root)\</td>
<td>B&#x2F;</td>
<td>匹配root或者B的行</td>
</tr>
<tr>
<td>\</td>
<td>转义字符</td>
<td>&#x2F;a//&#x2F;</td>
<td>匹配a&#x2F;&#x2F;</td>
<td></td>
<td></td>
</tr>
<tr>
<td><del>,!</del></td>
<td>匹配，不匹配的条件语句</td>
<td>$1~&#x2F;root&#x2F;</td>
<td>匹配第一个字段包含字符root的所有记录</td>
<td></td>
<td></td>
</tr>
<tr>
<td>x{m}x{m,}x{m,n}</td>
<td>x重复m次x重复至少m次x重复至少m次，但是不超过n次</td>
<td>&#x2F;(root){3}&#x2F;&#x2F;(root){3,}&#x2F;&#x2F;(root){3,6}&#x2F;</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>正则应用</p>
<p>规则表达式</p>
<p><code>awk &#39;/REG/&#123;action&#125; &#39; file</code> ,&#x2F;REG&#x2F;为正则表达式，可以将$0 中，满足条件的记录送入到：action 进行处理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;/root/&#123;print$0&#125;&#x27; /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk -F &quot;:&quot; &#x27;$5~/root/&#123;print$0&#125;&#x27; /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@node-1 ~]<span class="comment"># ifconfig ens33 | awk &#x27;BEGIN&#123;FS=&quot;[[:space:]:]+&quot;&#125; NR==2&#123;print$3&#125;&#x27;</span></span><br><span class="line">192.168.175.10</span><br></pre></td></tr></table></figure>

<p>布尔表达式</p>
<p><code>awk &#39;布尔表达式&#123;action&#125;&#39; file</code> 仅当对前面的布尔表达式求值为真时， awk 才执行代码块。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk -F: &#x27;$1==&quot;root&quot;&#123;print$0&#125;&#x27; /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[root@node-1 ~]<span class="comment"># awk -F: &#x27;($1==&quot;root&quot;)&amp;&amp;($5==&quot;root&quot;)&#123;print$0&#125;&#x27; /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<h2 id="awk-的-if、循环和数组"><a href="#awk-的-if、循环和数组" class="headerlink" title="awk 的 if、循环和数组"></a>awk 的 if、循环和数组</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><p>条件语句</p>
<p>awk 提供了非常好的类似于 C 语言的 if 语句。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$1</span>==<span class="string">&quot;foo&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$2</span>==<span class="string">&quot;foo&quot;</span>)&#123;</span><br><span class="line">        <span class="built_in">print</span><span class="string">&quot;uno&quot;</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">print</span><span class="string">&quot;one&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;elseif(<span class="variable">$1</span>==<span class="string">&quot;bar&quot;</span>)&#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;two&quot;</span></span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">print</span><span class="string">&quot;three&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用 if 语句还可以将代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">! /matchme/ &#123; <span class="built_in">print</span> <span class="variable">$1</span> <span class="variable">$3</span> <span class="variable">$4</span> &#125;</span><br></pre></td></tr></table></figure>

<p>转换成：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">　　<span class="keyword">if</span> ( <span class="variable">$0</span> !~ /matchme/ ) &#123;</span><br><span class="line">　　　　<span class="built_in">print</span> <span class="variable">$1</span> <span class="variable">$3</span> <span class="variable">$4</span></span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="while"><a href="#while" class="headerlink" title="while"></a>while</h3><p>循环结构</p>
<p>我们已经看到了 awk 的 while 循环结构，它等同于相应的 C 语言 while 循环。 awk 还有”do…while”循环，它在代码块结尾处对条件求值，而不像标准 while 循环那样在开始处求值。</p>
<p>它类似于其它语言中的”repeat…until”循环。以下是一个示例：</p>
<p>do…while 示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    count=1 <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;I get printed at least once no matter what&quot;</span></span><br><span class="line">    &#125; <span class="keyword">while</span> ( count !=1 )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>与一般的 while 循环不同，由于在代码块之后对条件求值， “do…while”循环永远都至少执行一次。换句话说，当第一次遇到普通 while 循环时，如果条件为假，将永远不执行该循环。</p>
<p>for 循环</p>
<p>awk 允许创建 for 循环，它就象 while 循环，也等同于 C 语言的 for 循环：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( initial assignment; comparison; increment ) &#123;</span><br><span class="line">    code block</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以下是一个简短示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( x=1;x&lt;=4;x++ ) &#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;iteration&quot;</span>, x</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>break 和 continue</p>
<p>此外，如同 C 语言一样， awk 提供了 break 和 continue 语句。使用这些语句可以更好地控制 awk 的循环结构。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/awk</span></span><br><span class="line">BEGIN&#123;</span><br><span class="line">x=1</span><br><span class="line"><span class="keyword">while</span>(1) &#123;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;iteration&quot;</span>,x</span><br><span class="line">    <span class="keyword">if</span> ( x==10 )&#123;</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    x++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>continue 语句补充了 break</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x=1</span><br><span class="line"><span class="keyword">while</span> (1) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( x==4 ) &#123;</span><br><span class="line">        x++</span><br><span class="line">        <span class="built_in">continue</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;iteration&quot;</span>, x</span><br><span class="line">    <span class="keyword">if</span> ( x&gt;20 ) &#123;</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    x++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>continue在for中使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/awk</span></span><br><span class="line">BEGIN&#123;</span><br><span class="line"><span class="keyword">for</span> (x=1;x&lt;=21;x++)&#123;</span><br><span class="line"><span class="keyword">if</span> (x==4)&#123;</span><br><span class="line">    <span class="built_in">continue</span></span><br><span class="line">&#125;</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;iteration&quot;</span>,x</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>AWK 中的数组都是关联数组,数字索引也会转变为字符串索引</p>
<p>在awk中，数组叫关联数组，与我们在其它编程语言中的数组有很大的区别。关联数组，简单来说，类似于python语言中的dict、java语言中的map，其下标不再局限于数值型，而可以是字符串，即下标为key，value&#x3D;array[key]。竟然为key，那其下标也不再是有序的啦。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/awk</span></span><br><span class="line">BEGIN&#123;</span><br><span class="line">    cities[1]=<span class="string">&quot;beijing&quot;</span></span><br><span class="line">    cities[2]=<span class="string">&quot;shanghai&quot;</span></span><br><span class="line">    cities[<span class="string">&quot;three&quot;</span>]=<span class="string">&quot;guangzhou&quot;</span></span><br><span class="line">    <span class="keyword">for</span>( c <span class="keyword">in</span> cities) &#123;</span><br><span class="line">        <span class="built_in">print</span> cities[c]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">print</span> cities[1]</span><br><span class="line">    <span class="built_in">print</span> cities[<span class="string">&quot;1&quot;</span>]</span><br><span class="line">    <span class="built_in">print</span> cities[<span class="string">&quot;three&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">awk -f awk.txt &lt;filename&gt;</span><br></pre></td></tr></table></figure>

<p>用 awk 中查看服务器连接状态并汇总</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># netstat -an|awk &#x27;/^tcp/&#123;++s[$NF]&#125;END&#123;for(a in s)print a,s[a]&#125;&#x27;</span></span><br><span class="line">LISTEN 8</span><br><span class="line">ESTABLISHED 1</span><br></pre></td></tr></table></figure>

<h2 id="常用字符串函数"><a href="#常用字符串函数" class="headerlink" title="常用字符串函数"></a>常用字符串函数</h2><p><img src="/BLOG/source/images/4.jpg"></p>
<p><img src="/BLOG/source/images/3.jpg" alt="3"></p>
<p>字符串函数的应用</p>
<p>在 info 中查找满足正则表达式， &#x2F;[0-9]+&#x2F; 用”!”替换，并且替换后的值，赋值给 info</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;gsub(/[0-9]+/,&quot;!&quot;,info);print info&#125;&#x27;</span></span><br><span class="line">this is a <span class="built_in">test</span>!<span class="built_in">test</span>!</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>BEGIN { … }</strong>: <code>BEGIN</code> 是一个特殊的 <code>awk</code> 模式，它在处理任何输入行之前执行。在这个 <code>BEGIN</code> 块中，你可以初始化变量或执行其他只需要执行一次的操作。</li>
<li><strong>info&#x3D;”this is a test2010test!”</strong>: 这行代码在 <code>BEGIN</code> 块中初始化了一个名为 <code>info</code> 的变量，并给它赋了一个字符串值 <code>&quot;this is a test2010test!&quot;</code>。</li>
<li><strong>gsub(&#x2F;[0-9]+&#x2F;,”!”,info)</strong>: <code>gsub</code> 是 <code>awk</code> 中的一个函数，用于在字符串中进行全局替换。这里，它查找 <code>info</code> 变量中所有的一个或多个连续数字（由正则表达式 <code>[0-9]+</code> 定义），并将它们替换为感叹号 <code>!</code>。</li>
</ol>
<p>所以，这行代码将 <code>info</code> 中的所有数字替换为感叹号。</p>
<ol start="4">
<li><strong>print info</strong>: 这行代码打印出修改后的 <code>info</code> 变量的值。</li>
</ol>
<p>如果查找到数字则匹配成功返回 ok，否则失败，返回未找到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;print index(info,&quot;test&quot;)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span></span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>BEGIN { … }</strong>: 正如之前提到的，<code>BEGIN</code> 是一个特殊的 <code>awk</code> 模式，它在处理任何输入行之前执行。</li>
<li><strong>info&#x3D;”this is a test2010test!”</strong>: 这行代码在 <code>BEGIN</code> 块中初始化了一个名为 <code>info</code> 的变量，并给它赋了一个字符串值 <code>&quot;this is a test2010test!&quot;</code>。</li>
<li><strong>index(info,”test”)</strong>: <code>index</code> 是 <code>awk</code> 的一个内置函数，它返回子字符串在字符串中首次出现的位置（基于1的索引）。如果子字符串没有在字符串中找到，则返回0。在这个例子中，<code>index(info,&quot;test&quot;)</code> 会返回 <code>8</code>，因为 “test” 首次出现在 <code>info</code> 变量的第8个字符位置。</li>
<li><strong>index(info,”test”)?”ok”:”no found”</strong>: 这是一个三元操作符，它基于 <code>index</code> 函数的返回值来决定输出什么。如果 <code>index</code> 返回非零值（即找到了子字符串），则输出 “ok”；否则输出 “no found”。</li>
<li><strong>print …</strong>: 这行代码打印出三元操作符的结果。</li>
</ol>
<p>从第 4 个 字符开始，截取 10 个长度字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;print substr(info,4,10);&#125;&#x27;</span></span><br><span class="line">s is a tes</span><br></pre></td></tr></table></figure>

<ol>
<li><p><strong>BEGIN { … }</strong>: 正如之前提到的，<code>BEGIN</code> 是一个特殊的 <code>awk</code> 模式，它在处理任何输入行之前执行。</p>
</li>
<li><p><strong>info&#x3D;”this is a test2010test!”</strong>: 这行代码在 <code>BEGIN</code> 块中初始化了一个名为 <code>info</code> 的变量，并给它赋了一个字符串值 <code>&quot;this is a test2010test!&quot;</code>。</p>
</li>
<li><p><strong>substr(info,4,10)</strong>: <code>substr</code> 是 <code>awk</code> 的一个内置函数，用于从字符串中提取子字符串。它接受三个参数：源字符串、起始位置和要提取的字符数。在这个例子中，它从 <code>info</code> 变量的第4个字符开始（基于1的索引），提取长度为10的子字符串。</p>
<p>对于 <code>info=&quot;this is a test2010test!&quot;</code>，从第4个字符开始（即 ‘i’），提取10个字符得到的子字符串是 “s is a tes”。</p>
</li>
<li><p><strong>print substr(info,4,10)</strong>: 这行代码打印出使用 <code>substr</code> 函数提取的子字符串。</p>
</li>
</ol>
<p>分割 info,动态创建数组 tA,awk for …in 循环，是一个无序的循环。 并不是从数组下标1…n 开始</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node-1 ~]<span class="comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test&quot;;split(info,tA,&quot; &quot;);print length(tA);for(k in tA)&#123;print k,tA[k];&#125;&#125;&#x27;</span></span><br><span class="line">4</span><br><span class="line">4 <span class="built_in">test</span></span><br><span class="line">1 this</span><br><span class="line">2 is</span><br><span class="line">3 a</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>BEGIN { … }</strong>: 如前所述，<code>BEGIN</code> 块在 <code>awk</code> 开始处理任何输入行之前执行。</li>
<li><strong>info&#x3D;”this is a test”</strong>: 在 <code>BEGIN</code> 块中初始化一个名为 <code>info</code> 的变量，并给它赋了一个字符串值 <code>&quot;this is a test&quot;</code>。</li>
<li><strong>split(info,tA,” “)</strong>: <code>split</code> 函数用于将字符串 <code>info</code> 根据指定的分隔符（在这个例子中是空格 <code>&quot; &quot;</code>）分割成一个数组 <code>tA</code>。这样，<code>tA[1]</code> 将会是 <code>&quot;this&quot;</code>，<code>tA[2]</code> 将会是 <code>&quot;is&quot;</code>，以此类推。</li>
<li><strong>print length(tA)</strong>: 打印数组 <code>tA</code> 的长度。由于字符串 <code>&quot;this is a test&quot;</code> 被空格分割成了四个部分，所以输出将是 <code>4</code>。</li>
<li><strong>for(k in tA) { print k, tA[k] }</strong>: 这是一个 <code>for</code> 循环，用于遍历数组 <code>tA</code>。在 <code>awk</code> 中，当你遍历数组时，<code>k</code> 会自动被赋值为数组的索引（在这个例子中是数字），而 <code>tA[k]</code> 则是相应的值。这个循环会打印出数组的每一个索引和对应的值。</li>
<li>首先，它打印出数组的长度 <code>4</code>。然后，它遍历数组并打印出每个元素的索引和值。注意，在 <code>awk</code> 中，数组的索引默认是从 <code>1</code> 开始的，而不是从 <code>0</code></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://blog.guixiang.top">Gui_xiang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://blog.guixiang.top/posts/33383/">http://blog.guixiang.top/posts/33383/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.guixiang.top" target="_blank">贵祥</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%9F%A5%E8%AF%86%E9%9B%86%E9%94%A6/">知识集锦</a></div><div class="post_share"><div class="social-share" data-image="https://api.aqcoder.cn/random" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/20345/" title="面试的开胃小菜2"><img class="cover" src="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">面试的开胃小菜2</div></div></a></div><div class="next-post pull-right"><a href="/posts/33575/" title="知识集锦1"><img class="cover" src="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">知识集锦1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/33575/" title="知识集锦1"><img class="cover" src="https://api.aqcoder.cn/random" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-29</div><div class="title">知识集锦1</div></div></a></div><div><a href="/posts/17062/" title="知识集锦3"><img class="cover" src="https://api.aqcoder.cn/random" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-30</div><div class="title">知识集锦3</div></div></a></div><div><a href="/posts/57251/" title="MySQL服务器安装"><img class="cover" src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240520195857.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-17</div><div class="title">MySQL服务器安装</div></div></a></div><div><a href="/posts/28762/" title="hexo个性封面设置"><img class="cover" src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240520202124.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-20</div><div class="title">hexo个性封面设置</div></div></a></div><div><a href="/posts/59810/" title="面筋知识点"><img class="cover" src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240523103333.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-23</div><div class="title">面筋知识点</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Gui_xiang</div><div class="author-info__description">分享知识，认识世界</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xiaowang872"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">更换了blog主题为butterfly</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="toc-number">1.</span> <span class="toc-text">通配符</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#find%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE"><span class="toc-number">2.</span> <span class="toc-text">find文件查找</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E6%9D%A1%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">查找条件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%8A%A8%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">处理动作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">正则表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bgrep"><span class="toc-number">4.</span> <span class="toc-text">Linux三剑客之grep</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">4.1.</span> <span class="toc-text">实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88%E5%9F%BA%E4%BA%8Egrep%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">正则表达式（基于grep）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">4.2.1.</span> <span class="toc-text">基础正则表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AD%A3%E5%88%99"><span class="toc-number">4.2.2.</span> <span class="toc-text">扩展正则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%B8%B8%E7%94%A8"><span class="toc-number">4.3.</span> <span class="toc-text">最常用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9C%E8%AF%B4%E6%98%8E"><span class="toc-number">4.4.</span> <span class="toc-text">动作说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-number">4.5.</span> <span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E8%A1%8C%E4%B8%BA%E5%8D%95%E4%BD%8D%E7%9A%84%E6%96%B0%E5%A2%9E-%E5%88%A0%E9%99%A4%EF%BC%88nl%E6%98%AF%E4%B8%AA%E6%95%B4%E4%BD%93%EF%BC%8C%E4%B8%8D%E5%8F%AF%E5%88%86%E5%89%B2%EF%BC%89"><span class="toc-number">4.5.1.</span> <span class="toc-text">以行为单位的新增&#x2F;删除（nl是个整体，不可分割）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E8%A1%8C%E4%B8%BA%E5%8D%95%E4%BD%8D%E7%9A%84%E6%9B%BF%E6%8D%A2%E4%B8%8E%E6%98%BE%E7%A4%BA"><span class="toc-number">4.5.2.</span> <span class="toc-text">以行为单位的替换与显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E5%AF%BB%E5%B9%B6%E6%98%BE%E7%A4%BA"><span class="toc-number">4.5.3.</span> <span class="toc-text">数据的搜寻并显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E5%AF%BB%E5%B9%B6%E5%88%A0%E9%99%A4"><span class="toc-number">4.5.4.</span> <span class="toc-text">数据的搜寻并删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E5%AF%BB%E5%B9%B6%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-number">4.5.5.</span> <span class="toc-text">数据的搜寻并执行命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%90%9C%E5%AF%BB%E5%B9%B6%E6%9B%BF%E6%8D%A2"><span class="toc-number">4.5.6.</span> <span class="toc-text">数据的搜寻并替换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%82%B9%E7%BC%96%E8%BE%91"><span class="toc-number">4.5.7.</span> <span class="toc-text">多点编辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9-%E5%8D%B1%E9%99%A9%E5%8A%A8%E4%BD%9C"><span class="toc-number">4.5.8.</span> <span class="toc-text">直接修改文件内容(危险动作)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux%E4%B8%89%E5%89%91%E5%AE%A2%E4%B9%8Bawk"><span class="toc-number">5.</span> <span class="toc-text">Linux三剑客之awk</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">5.1.</span> <span class="toc-text">使用方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk-%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-number">5.2.</span> <span class="toc-text">awk 的原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E5%8F%AA%E6%9F%A5%E7%9C%8Btest-txt%E6%96%87%E4%BB%B6%EF%BC%88100%E8%A1%8C%EF%BC%89%E5%86%85%E7%AC%AC20%E5%88%B0%E7%AC%AC30%E8%A1%8C%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%88%E4%BC%81%E4%B8%9A%E9%9D%A2%E8%AF%95%EF%BC%89"><span class="toc-number">5.2.1.</span> <span class="toc-text">实例一：只查看test.txt文件（100行）内第20到第30行的内容（企业面试）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C%EF%BC%9A%E5%B7%B2%E7%9F%A5test-txt%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E4%B8%BA"><span class="toc-number">5.2.2.</span> <span class="toc-text">实例二：已知test.txt文件内容为</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BEGIN-%E5%92%8C-END-%E6%A8%A1%E5%9D%97"><span class="toc-number">5.3.</span> <span class="toc-text">BEGIN 和 END 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%B8%80%EF%BC%9A%E7%BB%9F%E8%AE%A1-etc-passwd%E7%9A%84%E8%B4%A6%E6%88%B7%E4%BA%BA%E6%95%B0"><span class="toc-number">5.3.1.</span> <span class="toc-text">实例一：统计&#x2F;etc&#x2F;passwd的账户人数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BA%8C%EF%BC%9A%E7%BB%9F%E8%AE%A1%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6%E5%8D%A0%E7%94%A8%E7%9A%84%E5%AD%97%E8%8A%82%E6%95%B0"><span class="toc-number">5.3.2.</span> <span class="toc-text">实例二：统计某个文件夹下的文件占用的字节数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">5.4.</span> <span class="toc-text">awk运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8-awk-%E5%86%85%E7%BD%AE%E5%8F%98%E9%87%8F"><span class="toc-number">5.5.</span> <span class="toc-text">常用 awk 内置变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk%E6%AD%A3%E5%88%99"><span class="toc-number">5.6.</span> <span class="toc-text">awk正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk-%E7%9A%84-if%E3%80%81%E5%BE%AA%E7%8E%AF%E5%92%8C%E6%95%B0%E7%BB%84"><span class="toc-number">5.7.</span> <span class="toc-text">awk 的 if、循环和数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if"><span class="toc-number">5.7.1.</span> <span class="toc-text">if</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#while"><span class="toc-number">5.7.2.</span> <span class="toc-text">while</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">5.7.3.</span> <span class="toc-text">数组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">5.8.</span> <span class="toc-text">常用字符串函数</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/28504/" title="wordpress站点转移"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240713105601.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="wordpress站点转移"/></a><div class="content"><a class="title" href="/posts/28504/" title="wordpress站点转移">wordpress站点转移</a><time datetime="2024-07-13T02:16:11.000Z" title="发表于 2024-07-13 10:16:11">2024-07-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/60106/" title="docker无法安装而需要的换源需求："><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240708170659.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker无法安装而需要的换源需求："/></a><div class="content"><a class="title" href="/posts/60106/" title="docker无法安装而需要的换源需求：">docker无法安装而需要的换源需求：</a><time datetime="2024-07-08T09:16:11.000Z" title="发表于 2024-07-08 17:16:11">2024-07-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4057/" title="解决yum下载报错"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240702173901.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="解决yum下载报错"/></a><div class="content"><a class="title" href="/posts/4057/" title="解决yum下载报错">解决yum下载报错</a><time datetime="2024-07-02T09:30:22.000Z" title="发表于 2024-07-02 17:30:22">2024-07-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/53876/" title="大二下英语课后词汇题汇总"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/5c78b68a53ae451df1787f6e2105a1ec_1332597303243430727.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="大二下英语课后词汇题汇总"/></a><div class="content"><a class="title" href="/posts/53876/" title="大二下英语课后词汇题汇总">大二下英语课后词汇题汇总</a><time datetime="2024-06-03T14:16:11.000Z" title="发表于 2024-06-03 22:16:11">2024-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/51073/" title="mysql的DDL与DCL与DML与DQL"><img src="https://cdn.jsdelivr.net/gh/xiaowang872/blogimage@main/images/QQ%E6%88%AA%E5%9B%BE20240524234051.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mysql的DDL与DCL与DML与DQL"/></a><div class="content"><a class="title" href="/posts/51073/" title="mysql的DDL与DCL与DML与DQL">mysql的DDL与DCL与DML与DQL</a><time datetime="2024-05-24T15:45:21.000Z" title="发表于 2024-05-24 23:45:21">2024-05-24</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Gui_xiang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>